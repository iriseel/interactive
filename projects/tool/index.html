<!DOCTYPE html>
<html> 
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>capture and release</title>
    <link rel="icon" type="image/png" href="&#8779;"/>
 
      
    <link rel="stylesheet" href="style.css">
      
      
    </head>
    
  <body>
      
    <div class="bg_wrapper">
      <div class="bg"></div>
    </div>
      
      <div class="critter">
        <img src="img/palau/Jorunna_funebris.jpg" class="funebris">
    </div>
      
      
      <div class="critter">
        <img src="img/palau/fish.jpg" class="funebris">
    </div>
      
      <div class="info">
      If you want to capture another sea critter, you have to release the one you already got!
      </div>
      
      <div class="welcome">
        <p>
            Welcome to aquatic critters appreciation website! This is a place where sea lovers can upload their photos, and where viewers can experience the difficulties of visually capturing tiny, speedy ocean life that the photographers confronted when taking the photos!
        </p>
          <p>
              To view a photo, catch a critter.
          </p>
      </div>
      
      
      <div class="caption">
      tender
      </div>
      
      <div class="caption">
      violent
      </div>
      
      
      <div class="caption">
      symbiotic
      </div>
      
      <div class="caption">
      transience
      </div>
      
      <div class="caption">
      will the photos of these critters outlast their bodies?
      </div>
      
      
      
    
      
    <!--     displacement filter taken from https://www.youtube.com/watch?v=q-i0rZBZvBk
    It's cool but a lil too extra to use on entire sea bg :)

    <div class="displacement"></div>
      -->  
        <!-- 
            Make SVG top:0, otherwise it adds white space at bottom of document
        -->
        <svg style="position:absolute; z-index:-1; visibility:none; top:0;">
          <filter id="turbulence" x="0" y="0" width="100%" height="100%">
            <feTurbulence id="sea-filter" numOctaves="3" seed="2" baseFrequency="0.1 0.005"></feTurbulence>
            <feDisplacementMap scale="10" in="SourceGraphic"></feDisplacementMap>
            <animate xlink:href="#sea-filter" attributeName="baseFrequency" dur="30s" 
            keyTimes="0;0.5;1" values="0.02 0.06;0.04 0.08;0.02 0.06" repeatCount="indefinite"/>
          </filter>
        </svg>

      
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>

      
    <script type="text/javascript">
        
        
        //trying to randomize start positions of .critters
            
        var direction = "right",

            //?? How do I make this var caught specific to EACH img? Right now if i click 1 image it changes the var globally
            caught = false;
        
        setTimeout(function() {
            $(".welcome").css({
                    visibility: "hidden",
                    opacity: "0"
                });
            }, 1000);
        

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1) + min);
        };
            
            
            //define function that assigns random starting Y
           function randomY() {
               var height = $(window).height();
    
                var randomY = getRandomInt(height, 0);
               
                $(this).css({
                    top: randomY
                });
           }; 
           
            //apply randomY function to each instance of .critter and .caption
            $(".critter").each(randomY);
            
             $(".caption").each(randomY);
            
        
            
            //randomize swimming and bouncing animations: using callback instead of setInterval to loop animations (because otherwise when I clearInterval on $("img").click, it would clear ALL the animations on other critters as well, not just the animation on the clicked critter)
           
        //?? This was working before but now neither the speed nor the bounce are randomizing between critters??? Console.log shows that speeds are being randomized but they don't look it??
        
        var critters = $(".critter");
        var random_bounces_small = [],
            random_bounces_big = [],
            random_speeds = [],
            critter_counter_big = 0,
            critter_counter_small = 0,
            critters_length = critters.length;
        
        // create random bounce amounts, add to array
        for (let i = 0; i < critters.length; i++) {
            
            var random_bounce_big = Math.floor(Math.random() * 200 + 50);
            
            random_bounces_big.push(random_bounce_big);
            
            var random_bounce_small = Math.floor(Math.random() * 100 + 50);
            
            random_bounces_small.push(random_bounce_small);
            
            var random_speed = Math.floor(Math.random() * 200 + 100);
            
            random_speeds.push(random_speed);
        };
        
        
        
        function big_bounce(){
            if (critter_counter_big < critters.length - 1) {
                $(this).animate(
                        {top:"+=" + random_bounces_big[critter_counter_big],
                        left:"+=" + random_speeds[critter_counter_big]}, 600);

                    $(this).animate(
                        {top:"-=" + random_bounces_big[critter_counter_big],
                        left:"+=" + random_speeds[critter_counter_big]}, 600, small_bounce);
            
                    critter_counter_big++;
               }
            
            else {
                critter_counter_big = 0;
                
                $(this).animate(
                        {top:"+=" + random_bounces_big[critter_counter_big],
                        left:"+=" + random_speeds[critter_counter_big]}, 600);

                    $(this).animate(
                        {top:"-=" + random_bounces_big[critter_counter_big],
                        left:"+=" + random_speeds[critter_counter_big]}, 600, small_bounce);
            
                    critter_counter_big++;
            }
        };
            
            
        function small_bounce(){
            if (critter_counter_small < critters.length - 1) {

                $(this).animate(
                    {top:"+=" + random_bounces_small[critter_counter_small],
                    left:"+=" + random_speeds[critter_counter_small]}, 600);

                $(this).animate(
                    {top:"-=" + random_bounces_small[critter_counter_small],
                    left:"+=" + random_speeds[critter_counter_small]}, 600, big_bounce);
                }
            else {
                critter_counter_small = 0;
                
                $(this).animate(
                    {top:"+=" + random_bounces_small[critter_counter_small],
                    left:"+=" + random_speeds[critter_counter_small]}, 600);

                $(this).animate(
                    {top:"-=" + random_bounces_small[critter_counter_small],
                    left:"+=" + random_speeds[critter_counter_small]}, 600, big_bounce);
            }
        };
               
                
//                $(".critter").eq(critter_counter_big).animate(
//                    {top:"-=" + random_bounces_small[critter_counter_small],
//                    left:"+=" + random_speeds[critter_counter_small]}, 600, big_bounce);
                
                
//                //??How do I add easing to this so it's not so 走走停停???
//                $(".critter").each(big_bounce); 
//
//                $(".caption").each(big_bounce); 
//        
        
        
        
        
        
//               function big_bounce(){
//                   
//                    var random_bounce1 = Math.floor(Math.random() * 200 + 50);
//                   
//                    random_speed = Math.floor(Math.random() * 200 + 100);
//                    console.log("random speed is" + random_speed);
//
//                    $(this).animate(
//                        {top:"+=" + random_bounce1,
//                        left:"+=" + random_speed}, 600);
//
//                    $(this).animate(
//                        {top:"-=" + random_bounce1,
//                        left:"+=" + random_speed}, 600, small_bounce);
//               };
//
//                function small_bounce(){
//                    
//                    var random_bounce2 = Math.floor(Math.random() * 100 + 50);
//
//                    $(this).animate(
//                        {top:"+=" + random_bounce2,
//                        left:"+=" + random_speed}, 600);
//
//                    $(this).animate(
//                        {top:"-=" + random_bounce2,
//                        left:"+=" + random_speed}, 600, big_bounce);
//                };
//               
//                
//            
                //??How do I add easing to this so it's not so 走走停停???
                $(".critter").each(big_bounce); 

                $(".caption").each(big_bounce); 
    
             
               
                
                function big_bounce_reverse(){
                   
                     var random_bounce1 = Math.floor(Math.random() * 200 + 50);

                    $(this).animate(
                        {top:"+=" + random_bounce1,
                        left:"-=" + random_speed}, 600);

                    $(this).animate(
                        {top:"-=" + random_bounce1,
                        left:"-=" + random_speed}, 600, small_bounce_reverse);
               };

                function small_bounce_reverse(){
                    
                    var random_bounce2 = Math.floor(Math.random() * 100 + 50);

                    $(this).animate(
                        {top:"+=" + random_bounce2,
                        left:"-=" + random_speed}, 600);

                    $(this).animate(
                        {top:"-=" + random_bounce2,
                        left:"-=" + random_speed}, 600, big_bounce_reverse);
                };
               
         
           function check_offset() {
               
                var offset = $(this).offset();
                var offset_left = offset.left;
               
                var width = $(".bg_wrapper").width();
               
               
//               console.log("offset is" + offset_left);
//               console.log("window width is" + width);
               
                if ((offset_left > width) && (direction === "right")) {
                    $(this).stop();
                    
                    //have to specify a starting animate, can't just do $(this).animate( {}, large_bounce_reverse — for whatever reason that makes everything just go up, no bounce down
                     $(this).animate(
                        {top:"+=200",
                        left:"-=100"}, 600);

                    $(this).animate(
                        {top:"-=200",
                        left:"-=100"}, 600, big_bounce_reverse);
                    
                    // this doesn't seem to actually set direction to left? direction remains right
                        direction = "left";

                }
               
               else if ((offset_left < 0) && (direction === "left")) {
                    $(this).stop();
                    
                     $(this).animate(
                        {top:"+=200",
                        left:"+=100"}, 600);

                    $(this).animate(
                        {top:"-=200",
                        left:"+=100"}, 600, big_bounce);

                };
               
               console.log("direction is" + direction);
            };
            
            
            function checking_offset(){
                $(".critter").each(check_offset);
                $(".caption").each(check_offset);
                
            };
            
            
          //var checking_offset = setInterval(checking_offset, 1000);
           
    
        
        
        
        //Make image escape cursor
      $(".critter").mouseenter(function() {
        
          
          console.log("escaping!");
          
          //MUST PUT if statement INSIDE a function for it to check for truth/false on each mouseover, rather than only on page load
          if (caught == false) { 
              
            var this_critter_counter_big = $(".critter").index(this);
              
            console.log("This critter is #" + this_critter_counter_big);
              
              console.log("This critter bounce is" + random_bounces_big[this_critter_counter_big]);
              
              // subtract image width and height from document dimensions if you don't wnat image to escape offscreen
              var wWidth = $(window).width(),
                  wHeight = $(window).height(),

              //dWidth/2 is maximum value, + 100 is minimum
                  nextX = Math.floor(Math.random() * (wWidth)) + 100,
                  nextY = Math.floor(Math.random() * (wHeight)) + 100;
              
                $(this).stop();

                $(this).animate({
                  left: nextX + "px",
                  top: nextY + "px"
                });
              
              
              if (direction === "right") {
                        
                        $(this).animate({
                            top: "+=" + random_bounces_big[this_critter_counter_big],
                            left: "+=" + random_speed
                        }, 600);

                        $(this).animate({
                            top: "-=" + random_bounces_big[this_critter_counter_big],
                            left: "+=" + random_speed
                        }, 600, big_bounce);
                    } 
                  
                    else if (direction === "left") {
                        $(this).animate({
                            top: "+=100",
                            left: "-=" + random_speed
                        }, 600);

                        $(this).animate({
                            top: "-=100",
                            left: "-=" + random_speed
                        }, 600, big_bounce_reverse);
                    };
            }
              
              
          else {
              
              
              // want to delay the restarting of bouncing animation so the escaping animation has time to run
              setTimeout(function() {
                    if (direction === "right") {
                        
                        $(this).animate({
                            top: "+=" + random_bounces_big[this_critter_counter_big],
                            left: "+=" + random_speed
                        }, 600);

                        $(this).animate({
                            top: "-=" + random_bounces_big[this_critter_counter_big],
                            left: "+=" + random_speed
                        }, 600, big_bounce);
                    } 
                  
                    else if (direction === "left") {
                        $(this).animate({
                            top: "+=100",
                            left: "-=" + random_speed
                        }, 600);

                        $(this).animate({
                            top: "-=100",
                            left: "-=" + random_speed
                        }, 600, big_bounce_reverse);
                    };
                }, 3000);
              
            };
               
          });
          
        
          
        
        $("img").click(function() {
            
            //?? related to the var caught problem; i tried to make a second var to tie it to this ??
            var this_caught = true,
                currentX,
                currentY,
                offset;

            offset = $(this).offset();
            currentX = offset.left;
            currentY = offset.top;

//                console.log(currentX);
//                console.log(currentY);

            if (caught == false) {
                
                //stop animation on clicked .critter
                $(this).parent().stop();

                $(this).css({
                    width: "100%",
                    filter: "blur(0px)"
                });

                $(this).parent().css({
                    top: "0vh",
                    left: "0vw",
                    width: "100vw",
                    height: "100vh"
                });


                var caught_sfx = new Audio("sfx/victory.mp3");
                caught_sfx.play();

                caught = true;
                
            }
            
            else if ((caught == true) && (this_caught == true)) {
                
                $(this).css({
                    width: "100px",
                    filter: "blur(10px)"
                });

                $(this).parent().css({
                    top: currentY + "px",
                    left: currentX + "px",
                    width: "400px",
                    height: "400px"
                });
                     
                caught = false;
                
                }
            
            else {
                $(".info").css({
                    visibility: "visible",
                    opacity: "1"
                })
            };
            
                console.log("caught is" + caught);  
            });
        
                     
          
          
          
    </script>

  </body>
</html>
